\documentclass[b5paper,fleqn]{ltjsarticle}
\usepackage{braket,luatex85,qcircuit,caption,here}
\usepackage[fleqn]{amsmath}
\captionsetup{labelformat=empty}
\newcommand\s[1]{\subsection*{#1}\noindent\ignorespaces}
\newcommand\al[1]{\begin{align*}#1\end{align*}}
\newcommand\tx{\intertext}
\newcommand\mat[2]{\left(\begin{array}{#1}#2\end{array}\right)}
\newcommand\qcirc[2]{\begin{figure}[H]\centerline{\Qcircuit{#1}}\caption{#2}\end{figure}}
\begin{document}
\begin{description}
\item [タイトル] 量子計算理論
\item [著者] 森前智行
\item [訳者] 
\item [出版日] 2017/11/14
\item [出版社] 森北出版
\item [ISBN10] 4627854013
\item [ISBN13] 9784627854017
\item [ページ数] 183
\item [言語] ja
\item [内容]従来のコンピュータのしくみと何がどう違うのか?なぜ速いのか?気鋭の若手研究者が基礎から最先端の話題までを幅広く解説.
  \vskip5pt
\item [版]1 
\item [刷]2
\end{description}
{\bf 注意点:}\vskip5pt
本書のp14で与えられるテンソル積のルール以外に、次の式を仮定する。
\[(\ket{a}\bra{b})\otimes(\ket{c}\bra{d})=\ket{ac}\bra{bd}\]
さらに一般に(積が上手く定義できる時)
\[AB\otimes CD=(A\otimes B)\cdot(C\otimes D)\]
が言える。ここで$\cdot$は行列としての積を意味する。

\s{p6,古典計算機の場合はベクトルのL1ノルムが保存される---}
\begin{itemize}
  \item L1ノルム $x_1+x_2$
  \item L2ノルム $x_1^2+x_2^2$
\end{itemize}
\s{p12,演習問題,チューリングマシンで実際に足し算と---}
motomu
\s{p13,演習問題,チューリングマシンのテープのビット列が---}
motomu
\s{p14,古典計算機の状態は$2^n$次元線形空間の---ということもできる。}
ここはテンソル積を知らなければ理解できない。
基底の数を次元と言い、$n$次元線型空間と$m$次元線型空間のテンソル積$V\otimes V$は$n\times m$
次元線型空間となる。\par
\underline{\bf 例}\par\noindent
2次元線型空間$V$の基底を$e_1,e_2$とするとき$e_1\otimes e_1,e_1\otimes e_2,e_2\otimes e_1,
e_2\otimes e_2$は$V\otimes V$の基底となる。ここではこれら基底を
$\ket{00},\ket{01},\ket{10},\ket{11}$と書いている。
2ビットの古典計算機の状態は$2^2$次元線型空間の正規直交基底である!
\s{p15,演習問題,チューリングマシンが1+1を計算する様子を---}
motomu
\s{p15,演習問題,$X\ket{0}=\ket{1},X\ket{1}=\ket{0}$となることを---}
成分を用いて計算すると
\[\mat{cc}{ 0&1\\ 1&0}
    \mat{c}{1\\0}=\mat{c}{0\\1}\]
あるいは以下の表式から明らかである。
\[X=\ket{1}\bra{0}+\ket{0}\bra{1}\]

\s{p16,演習問題,任意の$a,b,c\in\{0,1\}$に対し、---}
\[T\ket{a,b,c}=\ket{a,b,c\oplus ab}\]
\al{T&:=(I\otimes I-\ket{11}\bra{11})\otimes I+\ket{11}\bra{11}\otimes X\\
T\ket{a,b,c}&=(I\ket{a}\otimes I\ket{b}-\ket{11}\braket{11|a,b})
\otimes I\ket{c}+\ket{11}\braket{11|a,b}\otimes X\ket{c}\\
&=\ket{a,b,c}+\ket{11}\braket{11|a,b}\otimes(-\ket{c}+X\ket{c})
}
ここで$a,b$が11以外であれば後ろの項は落ちる。11であれば
\[\ket{11,c}-\ket{11,c}+\ket{11,\lnot c}=\ket{11,\lnot c}\]
より言える。
\s{p19,演習問題,上記の演算子を$\ket{00},\ket{01},\ket{10},\ket{11}$に作用させて---}
motomu
\s{p19,演習問題,---を表す3\times 3の確率行列を書け.}
motomu
\s{p19,演習問題,---も,この条件を必ず満たすことを示せ.}
$\psi$を$w$を用いて$\sum_wc_w\ket{w}$と書いておき、
$S\ket{\psi}$を計算する。
\[S(\{p_{z',z}\}):=\sum_{z\in\{0,1\}^n}\sum_{z'\in\{0,1\}^n}p_{z',z}
\ket{z'}\bra{z}\]
であるから
\al{S\ket{\psi}&=\sum_{z\in\{0,1\}^n}\sum_{z'\in\{0,1\}^n}
\sum_{w\in\{0,1\}^n}p_{z',z}c_w\ket{z'}\braket{z|w}\\
&=\sum_{z,z',w}p_{z',z}c_w\delta_{zw}\ket{z'}\\
&=\sum_{z,z'}p_{z',z}c_z\ket{z'}
}
ここで係数に注目すると、
\[\sum_z\left(\sum_{z'}p_{z',z}c_z\right)
=\sum_zc_z\left(\sum_{z'}p_{z',z}\right)
=\sum_zc_z=1\]
より言えた。
\s{p25,演習問題,$\{p_{z',z}\}_{z,z'\in\{0,1\}^n}$が式(3,1)を満たすなら---}
p19の演習問題と同様にして
\[U\ket{\psi}=\sum_{z'}
\underline{\sum_zp_{z',z}c_{z}}\ket{z'}\]
を得る。下線部を新たに$c_{z'}$と看做して、
$\sum_{z'}|c_{z'}|^2=1$を示せば良い。
\al{
  \sum_{z'}|c_{z'}|^2&=\sum_{z'}\sum_\alpha\sum_\beta
  p_{z',\alpha}^*c_\alpha^*p_{z',\beta}c_\beta\\
  &=\sum_{\alpha,\beta}\delta_{\alpha\beta}c^*_\alpha c_\beta\\
  &=\sum_\alpha|c_\alpha|^2=1
}

\s{p25,よりシンプルな式と等価であることが分かる。}
ユニタリー行列とは$U^\dagger U=I$を満たすような行列である。
ここで$\dagger$はエルミート転置を表す
\footnote{物理ではエルミート転置に$\dagger$を用いるが、数学では$*$を用いることが多い。
エルミート共軛、エルミート随伴、エルミート共役、あるいは随伴行列とも呼ばれる。}。
行列$A$を$(i,j)$成分$a_{ij}$を用いて$(a_{ij})$と書くことがある。この記号を用いれば、
$A^\dagger=(a^*_{ji})$である\footnote{物理では複素共役に$*$を用いるが、
数学では$\overline{z}$のように上線で表すことが多い。}。したがって、
\[U^\dagger U=\left(\sum_k u^*_{ki}u_{kj}\right)=\left(\delta_{ij}\right)=I\]
である。演算子$U$の定義を用いて$U^\dagger U$を計算する。
\al{
  U^\dagger U&=\sum_{\alpha\in\{0,1\}^n}\sum_{\beta\in\{0,1\}^n}p^*_{\alpha,\beta}
  \ket{\beta}\bra{\alpha}
  \sum_{\alpha'\in\{0,1\}^n}\sum_{\beta'\in\{0,1\}^n}p_{\alpha',\beta'}
  \ket{\alpha'}\bra{\beta'}\\
  &=\sum_{\alpha,\beta,\alpha',\beta'}p^*_{\alpha,\beta}p_{\alpha',\beta'}
  \delta_{\alpha,\alpha'}\ket{\beta}\bra{\beta'}\\
  &=\sum_{\alpha,\beta,\beta'}p^*_{\alpha,\beta}p_{\alpha,\beta'}\ket{\beta}\bra{\beta'}
  \tx{ここで式(3.1)を用いると、}
  &=\sum_{\beta,\beta'}\delta_{\beta,\beta'}\ket{\beta}\bra{\beta'}\\
  &=\sum_{\beta}\ket{\beta}\bra{\beta}=I
}
逆に$U^\dagger U=I$を仮定すると
\[\sum_{\beta,\mu,\nu}p^*_{\beta,\mu}p_{\beta,\nu}\ket{\mu}\bra{\nu}=I\]
を得るから、左から$\bra{\alpha}$を右から$\ket{\gamma}$を掛けることで、式$(3,1)$を
導出することができる。\par
ちなみに$\sum_{\beta}\ket{\beta}\bra{\beta}=I$であるが、1ビットの具体例を計算して見るとよく分かる。
\[ \sum_{\beta\in\{0,1\}}\ket{\beta}\braket{\beta|\psi}=
(\ket{0}\bra{0}+\ket{1}\bra{1})(c_0\ket{0}+c_1\ket{1})=c_0\ket{0}+c_1\ket{1}=\ket{\psi}\]

\s{p27,演習問題,以下が成り立つことを確認せよ.}
\[\ket{\psi}=\sum_{y\in\{0,1\}^{n-1}}c_{1y}\ket{1y}+\sum_{y\in\{0,1\}^{n-1}}c_{0y}\ket{0y}\]

\s{p35,演習問題,パウリ演算子は以下の性質を満たすことを---}
\[XX=\left(\ket{1}\bra{0}+\ket{0}\bra{1}\right)\left(\ket{1}\bra{0}+\ket{0}\bra{1}\right)
=\ket{0}\bra{0}+\ket{1}\bra{1}=I\]
\[YY=\left(i\ket{1}\bra{0}-i\ket{0}\bra{1}\right)\left(i\ket{1}\bra{0}-i\ket{0}\bra{1}\right)
=\ket{0}\bra{0}+\ket{1}\bra{1}=I\]
\[ZZ=\left(\ket{0}\bra{0}-\ket{1}\bra{1}\right)\left(\ket{0}\bra{0}-\ket{1}\bra{1}\right)
=\ket{0}\bra{0}+\ket{1}\bra{1}=I\]
\s{p35,演習問題,またパウリ演算子の固有値、固有ベクトルを求めよ.}
motomu
\s{p35,演習問題,さらに, n量子ビットパウリ演算子は掛け算について ---}
motomu
\s{p35,量子ゲートには, パウリゲートのほかに, アダマール(Hadamard)ゲートや---}
p28で導入された記号
\[\ket{+}=\frac{1}{\sqrt{2}}(\ket{0}+\ket{1})\]
\[\ket{-}=\frac{1}{\sqrt{2}}(\ket{0}-\ket{1})\]
を用いれば
\[H\equiv \ket{+}\bra{0}+\ket{-}\bra{1}\]
と書くことができる。

\s{p36,$R_{2/\pi}=Z^{1/2}$}
$\mat{cc}{1&0\\0&i}$を2乗すると$Z$になる。
\s{p36,一般に --- コントロールUゲート(controlled-U gate)と呼ばれる.}
容易に示せるように
\[\Lambda(A)\Lambda(B)=\Lambda(AB)\]
である。
\s{p36,CCZゲート --- がよく使われる.}
$I^{\otimes2}$を明示的に書くと、
\al{
  I^{\otimes2}
&=(\ket{0}\bra{0}+\ket{1}\bra{1})\otimes(\ket{0}\bra{0}+\ket{1}\bra{1})\\
&=\ket{00}\bra{00}+\ket{10}\bra{10}+\ket{01}\bra{01}+\ket{11}\bra{11}
}である。これをCCZの定義に代入すると、
\al{
CCZ:&=(I^{\otimes 2}-\ket{11}\bra{11})\otimes I+\ket{11}\bra{11}\otimes Z\\
&=(\ket{00}\bra{00}+\ket{10}\bra{10}+\ket{01}\bra{01})\otimes I+\ket{11}\bra{11}\otimes Z
}を得る。この式を眺めると、CCZの意味がはっきりと分かる。\par
また、$\Lambda(U)$に関しても同様の形に書き換えておこう。
\al{\Lambda(U)
&=\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes U\\
&=(I-\ket{1}\bra{1})\otimes I+\ket{1}\bra{1}\otimes U
}
以上の議論からより高次の一般形についても容易に導出できる。
\[CCZ=\ket{0}\bra{0}\otimes I^{\otimes 2}+\ket{1}\bra{1}\otimes CZ\]
なお$CCZ$はこのようにかけることも注意しておく。

\s{p37,演習問題,CZゲートは、コントロールとターゲットを入れ替えても ---}
それぞれ計算する。
\al{
\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes Z
&=\ket{0}\bra{0}\otimes(\ket{0}\bra{0}+\ket{1}\bra{1})+\ket{1}\bra{1}\otimes
(\ket{0}\bra{0}-\ket{1}\bra{1})\\
&=\ket{00}\bra{00}+\ket{01}\bra{01}+\ket{10}\bra{10}-\ket{11}\bra{11}
}
\al{
I\otimes\ket{0}\bra{0}+Z\otimes\ket{1}\bra{1}
&=(\ket{0}\bra{0}+\ket{1}\bra{1})\otimes\ket{0}\bra{0}+(\ket{0}\bra{0}-\ket{1}\bra{1})\otimes\ket{1}\bra{1}\\
&=\ket{00}\bra{00}+\ket{10}\bra{10}+\ket{01}\bra{01}-\ket{11}\bra{11}
}
\s{p37,演習問題,また図4,1(f)のようにCXゲートをコントロールと ---}
\qcirc{
& \ctrl{1} & \targ     & \ctrl{1} & \qw \\
& \targ    & \ctrl{-1} & \targ     & \qw
}{SWAP Gate}
p16で導入した記号$\oplus$(exclusive or)を用いると
\al{CX\ket{\psi\phi}&=(\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes X)\ket{\psi\phi}\\
&=\delta_{0\psi}\ket{0\phi}+\delta_{1\psi}\ket{1\lnot\phi}\\
&=\ket{\psi,\psi\oplus\phi}
}
が分かる。同様にコントロールとターゲットを入れ替えたものを$CX'$とすると、
\[CX'\ket{\psi\phi}=\ket{\psi\oplus\phi,\phi}\]が言える。これらから、
\[CX'CX\ket{\psi\phi}=\ket{\psi\oplus(\psi\oplus\phi),\psi\oplus\phi}=\ket{\phi,\psi\oplus\phi}\]
ここで$\oplus$を2回取ると元に戻ることを使った。同様にすれば
\[CXCX'CX\ket{\psi\phi}=\ket{\phi\psi}\]

\s{p37,演習問題,CCZゲートは、図4.2の回路と等価であることを確認せよ。}
\qcirc{
&\qw              &\ctrl{1}&\qw                      &\ctrl{1} &\ctrl{2}        &\qw\\
&\ctrl{1}         &\targ   &\ctrl{1}                 &\targ    &\qw             &\qw\\
&\gate{R_{\pi/2}} &\qw     &\gate{R^\dagger_{\pi/2}} &\qw      &\gate{R_{\pi/2}}&\qw
}{CCZ equivalent}
最後のゲートを除いて先に計算する。\\
巻末に示した公式集において$A=R_{\pi/2},B=X,C=R^\dagger_{\pi/2},D=X$とすると、
\al{
&\ket{0}\bra{0}\otimes\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes\ket{0}\bra{0}D\otimes R_{2/\pi}^\dagger\\
&\quad+\ket{0}\bra{0}\otimes\ket{1}\bra{1}\otimes I+\ket{1}\bra{1}\otimes\ket{1}\bra{1}\otimes R_{2/\pi}
}
を得る。これに最後のゲート
\[\ket{0}\bra{0}\otimes I\otimes I+\ket{1}\bra{1}\otimes I\otimes R_{2/\pi}\]
を掛ければ言える。

\s{p38,演習問題,図4.3の回路において, 一番上の量子ビットを---}
\[\frac{2+\braket{\phi|U\phi}+\braket{\phi|U^\dagger|\phi}}{4}\]

\newpage\section*{等価ゲート集}
\subsection{Toffoli}
\begin{minipage}{30pt}
\Qcircuit{
& \ctrl{1}    & \qw \\
& \ctrl{1}    & \qw \\
& \targ & \qw
}
\end{minipage}\quad=\quad
\begin{minipage}{30pt}
\Qcircuit{
  &  \qw& \ctrl{1}    & \qw &\qw\\
  &  \qw& \ctrl{1}    & \qw &\qw\\
  &  \gate{H}& \ctrl{0} & \gate{H}&\qw }
\end{minipage}
\subsection{CCZ}
\begin{minipage}{30pt}
\Qcircuit{
& \ctrl{1}    & \qw \\
& \ctrl{1}    & \qw \\
&\ctrl{0} & \qw
}
\end{minipage}\quad=\quad
\begin{minipage}{30pt}
\Qcircuit{
&\qw              &\ctrl{1}&\qw                      &\ctrl{1} &\ctrl{2}        &\qw\\
&\ctrl{1}         &\targ   &\ctrl{1}                 &\targ    &\qw             &\qw\\
&\gate{R_{\pi/2}} &\qw     &\gate{R^\dagger_{\pi/2}} &\qw      &\gate{R_{\pi/2}}&\qw
}
\end{minipage}
\newpage\section*{公式集}\label{formula}
\subsection{$(I\otimes\Lambda(A))(\Lambda(B)\otimes I)$}
\noindent\ignorespaces
\al{&\ket{0}\bra{0}\otimes\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes\ket{0}\bra{0}B\otimes I\\
&\quad+\ket{0}\bra{0}\otimes\ket{1}\bra{1}\otimes A+\ket{1}\bra{1}\otimes\ket{1}\bra{1}B\otimes A
}
\subsection{$(I\otimes\Lambda(A))(\Lambda(B)\otimes I)(I\otimes\Lambda(C))(\Lambda(D)\otimes I)$}
\noindent\ignorespaces
\al{&\ket{0}\bra{0}\otimes\ket{0}\bra{0}\otimes I+\ket{1}\bra{1}\otimes\ket{0}\braket{0|B|0}\bra{0}D\otimes I\\
&\quad+\ket{1}\bra{1}\otimes\ket{0}\braket{0|B|1}\bra{1}D\otimes C+\ket{0}\bra{0}\otimes\ket{1}\bra{1}\otimes AC\\
&\qquad+\ket{1}\bra{1}\otimes\ket{1}\braket{1|B|0}\bra{0}D\otimes A
+\ket{1}\bra{1}\otimes\ket{1}\braket{1|B|1}\bra{1}D\otimes AC\\
}
\end{document}
